<!DOCTYPE html>
<html lang="fr" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout Express - TechViral</title>
    <meta name="description" content="Finalisez votre commande rapidement et en sécurité. Paiement en un clic, livraison gratuite 48h.">
    
    <!-- PWA Meta -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#6366f1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#6366f1',
                        secondary: '#f59e0b',
                        accent: '#10b981'
                    }
                }
            },
            darkMode: 'selector'
        }
    </script>
    
    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' https:; script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://js.stripe.com; style-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com;">
</head>
<body class="bg-gray-50 dark:bg-gray-900 min-h-full">
    
    <!-- Progress Bar -->
    <div class="bg-white dark:bg-gray-800 shadow-sm">
        <div class="max-w-3xl mx-auto px-4 py-3">
            <div class="flex items-center justify-between text-sm">
                <span class="text-gray-600 dark:text-gray-400">Étape 1 sur 1</span>
                <span class="text-primary font-medium">Checkout Express</span>
            </div>
            <div class="mt-2 bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                <div class="bg-gradient-to-r from-primary to-secondary h-2 rounded-full transition-all duration-500" style="width: 100%"></div>
            </div>
        </div>
    </div>

    <div class="max-w-5xl mx-auto px-4 py-6">
        <div class="grid lg:grid-cols-2 gap-8">
            
            <!-- Formulaire de commande -->
            <div class="order-2 lg:order-1">
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                    
                    <!-- Header -->
                    <div class="mb-6">
                        <h1 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">
                            🚀 Checkout Express
                        </h1>
                        <p class="text-gray-600 dark:text-gray-400">
                            Commande rapide et sécurisée en moins de 2 minutes
                        </p>
                    </div>

                    <form id="expressCheckoutForm" class="space-y-6">
                        
                        <!-- Informations client -->
                        <div class="checkout-section">
                            <h3 class="flex items-center text-lg font-semibold mb-4">
                                👤 Informations de livraison
                                <span class="ml-2 text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full">Sécurisé</span>
                            </h3>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                        Email *
                                    </label>
                                    <input 
                                        type="email" 
                                        id="email" 
                                        required
                                        class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-primary transition-colors"
                                        placeholder="votre.email@exemple.com"
                                        autocomplete="email"
                                    >
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                        Prénom *
                                    </label>
                                    <input 
                                        type="text" 
                                        id="firstName" 
                                        required
                                        class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-primary transition-colors"
                                        placeholder="Jean"
                                        autocomplete="given-name"
                                    >
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                        Nom *
                                    </label>
                                    <input 
                                        type="text" 
                                        id="lastName" 
                                        required
                                        class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-primary transition-colors"
                                        placeholder="Dupont"
                                        autocomplete="family-name"
                                    >
                                </div>
                                
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                        Adresse *
                                    </label>
                                    <input 
                                        type="text" 
                                        id="address" 
                                        required
                                        class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-primary transition-colors"
                                        placeholder="123 Rue de la Paix"
                                        autocomplete="street-address"
                                    >
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                        Code postal *
                                    </label>
                                    <input 
                                        type="text" 
                                        id="zipCode" 
                                        required
                                        pattern="[0-9]{5}"
                                        class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-primary transition-colors"
                                        placeholder="75001"
                                        autocomplete="postal-code"
                                    >
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                        Ville *
                                    </label>
                                    <input 
                                        type="text" 
                                        id="city" 
                                        required
                                        class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-primary transition-colors"
                                        placeholder="Paris"
                                        autocomplete="locality"
                                    >
                                </div>
                                
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                        Téléphone *
                                    </label>
                                    <input 
                                        type="tel" 
                                        id="phone" 
                                        required
                                        class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-primary transition-colors"
                                        placeholder="06 12 34 56 78"
                                        autocomplete="tel"
                                    >
                                </div>
                            </div>
                        </div>

                        <!-- Options de livraison -->
                        <div class="checkout-section">
                            <h3 class="flex items-center text-lg font-semibold mb-4">
                                🚚 Options de livraison
                                <span class="ml-2 text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full">Gratuite 48h</span>
                            </h3>
                            
                            <div class="space-y-3">
                                <label class="delivery-option flex items-center p-4 border-2 border-gray-200 dark:border-gray-600 rounded-lg cursor-pointer hover:border-primary transition-colors">
                                    <input type="radio" name="delivery" value="express" checked class="text-primary">
                                    <div class="ml-4 flex-1">
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <p class="font-medium text-gray-900 dark:text-white">Express 48h</p>
                                                <p class="text-sm text-gray-600 dark:text-gray-400">Livraison garantie sous 48h ouvrées</p>
                                            </div>
                                            <div class="text-right">
                                                <p class="font-bold text-green-600 dark:text-green-400">GRATUIT</p>
                                                <p class="text-xs text-gray-500">Habituellement 9,99€</p>
                                            </div>
                                        </div>
                                    </div>
                                </label>
                                
                                <label class="delivery-option flex items-center p-4 border-2 border-gray-200 dark:border-gray-600 rounded-lg cursor-pointer hover:border-primary transition-colors">
                                    <input type="radio" name="delivery" value="standard" class="text-primary">
                                    <div class="ml-4 flex-1">
                                        <div class="flex items-center justify-between">
                                            <div>
                                                <p class="font-medium text-gray-900 dark:text-white">Standard 5-7 jours</p>
                                                <p class="text-sm text-gray-600 dark:text-gray-400">Livraison économique</p>
                                            </div>
                                            <div class="text-right">
                                                <p class="font-bold text-green-600 dark:text-green-400">GRATUIT</p>
                                            </div>
                                        </div>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <!-- Paiement -->
                        <div class="checkout-section">
                            <h3 class="flex items-center text-lg font-semibold mb-4">
                                💳 Paiement sécurisé
                                <div class="ml-2 flex items-center space-x-1">
                                    <span class="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full">SSL</span>
                                    <span class="text-xs bg-green-100 text-green-700 px-2 py-1 rounded-full">256-bit</span>
                                </div>
                            </h3>
                            
                            <div class="payment-methods space-y-3">
                                <label class="payment-method flex items-center p-4 border-2 border-gray-200 dark:border-gray-600 rounded-lg cursor-pointer hover:border-primary transition-colors">
                                    <input type="radio" name="payment" value="card" checked class="text-primary">
                                    <div class="ml-4 flex items-center">
                                        <span class="font-medium text-gray-900 dark:text-white mr-3">Carte bancaire</span>
                                        <div class="flex space-x-1">
                                            <span class="text-lg">💳</span>
                                            <span class="text-lg">💎</span>
                                            <span class="text-lg">🏦</span>
                                        </div>
                                    </div>
                                </label>
                                
                                <label class="payment-method flex items-center p-4 border-2 border-gray-200 dark:border-gray-600 rounded-lg cursor-pointer hover:border-primary transition-colors">
                                    <input type="radio" name="payment" value="paypal" class="text-primary">
                                    <div class="ml-4 flex items-center">
                                        <span class="font-medium text-gray-900 dark:text-white mr-3">PayPal</span>
                                        <span class="text-lg">🅿️</span>
                                    </div>
                                </label>
                                
                                <label class="payment-method flex items-center p-4 border-2 border-gray-200 dark:border-gray-600 rounded-lg cursor-pointer hover:border-primary transition-colors">
                                    <input type="radio" name="payment" value="klarna" class="text-primary">
                                    <div class="ml-4 flex items-center justify-between flex-1">
                                        <div class="flex items-center">
                                            <span class="font-medium text-gray-900 dark:text-white mr-3">Paiement en 3x</span>
                                            <span class="text-lg">📅</span>
                                        </div>
                                        <span class="text-xs bg-orange-100 text-orange-700 px-2 py-1 rounded-full">0% frais</span>
                                    </div>
                                </label>
                            </div>

                            <!-- Champs carte (cachés par défaut) -->
                            <div id="cardFields" class="card-fields mt-4 space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                        Numéro de carte *
                                    </label>
                                    <input 
                                        type="text" 
                                        id="cardNumber" 
                                        placeholder="1234 5678 9012 3456"
                                        class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-primary transition-colors"
                                        autocomplete="cc-number"
                                    >
                                </div>
                                
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            Expiration *
                                        </label>
                                        <input 
                                            type="text" 
                                            id="cardExpiry" 
                                            placeholder="MM/AA"
                                            class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-primary transition-colors"
                                            autocomplete="cc-exp"
                                        >
                                    </div>
                                    
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                            CVV *
                                        </label>
                                        <input 
                                            type="text" 
                                            id="cardCvv" 
                                            placeholder="123"
                                            maxlength="4"
                                            class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-primary transition-colors"
                                            autocomplete="cc-csc"
                                        >
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Conditions -->
                        <div class="flex items-start space-x-3">
                            <input 
                                type="checkbox" 
                                id="terms" 
                                required
                                class="mt-1 text-primary focus:ring-primary border-gray-300 rounded"
                            >
                            <label for="terms" class="text-sm text-gray-600 dark:text-gray-400">
                                J'accepte les <a href="/pages/legal/terms.html" class="text-primary hover:underline">conditions générales de vente</a> 
                                et la <a href="/pages/legal/privacy.html" class="text-primary hover:underline">politique de confidentialité</a>
                            </label>
                        </div>

                        <!-- Bouton de commande -->
                        <button 
                            type="submit" 
                            id="submitOrder"
                            class="w-full bg-gradient-to-r from-primary to-secondary text-white font-bold py-4 px-6 rounded-xl hover:shadow-lg transform hover:scale-105 transition-all duration-200 flex items-center justify-center space-x-2"
                        >
                            <span>🚀</span>
                            <span>Finaliser ma commande</span>
                            <span id="totalPrice" class="bg-white/20 px-2 py-1 rounded">89,99€</span>
                        </button>
                        
                        <div class="text-center">
                            <p class="text-xs text-gray-500 dark:text-gray-400">
                                🔒 Paiement 100% sécurisé • 🚚 Livraison gratuite • 📞 Support 24/7
                            </p>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Récapitulatif commande -->
            <div class="order-1 lg:order-2">
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 sticky top-6">
                    
                    <h2 class="text-xl font-bold text-gray-900 dark:text-white mb-4">
                        📦 Récapitulatif de commande
                    </h2>

                    <!-- Produits -->
                    <div id="orderSummary" class="space-y-4 mb-6">
                        <!-- Les produits seront ajoutés dynamiquement -->
                    </div>

                    <!-- Code promo -->
                    <div class="promo-section mb-6">
                        <div class="flex space-x-2">
                            <input 
                                type="text" 
                                id="promoCode" 
                                placeholder="Code promo"
                                class="flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-primary transition-colors text-sm"
                            >
                            <button 
                                type="button"
                                id="applyPromo"
                                class="px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors text-sm font-medium"
                            >
                                Appliquer
                            </button>
                        </div>
                        <div id="promoMessage" class="hidden mt-2 text-sm"></div>
                    </div>

                    <!-- Totaux -->
                    <div class="border-t border-gray-200 dark:border-gray-700 pt-4 space-y-3">
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600 dark:text-gray-400">Sous-total</span>
                            <span id="subtotal" class="text-gray-900 dark:text-white">89,99€</span>
                        </div>
                        
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600 dark:text-gray-400">Livraison</span>
                            <span class="text-green-600 dark:text-green-400 line-through decoration-red-500">
                                <span class="text-gray-500 text-xs mr-1">9,99€</span>
                                GRATUIT
                            </span>
                        </div>
                        
                        <div id="promoDiscount" class="hidden flex justify-between text-sm">
                            <span class="text-gray-600 dark:text-gray-400">Réduction</span>
                            <span class="text-green-600 dark:text-green-400">-0,00€</span>
                        </div>
                        
                        <div class="border-t border-gray-200 dark:border-gray-700 pt-3">
                            <div class="flex justify-between text-lg font-bold">
                                <span class="text-gray-900 dark:text-white">Total</span>
                                <span id="finalTotal" class="text-primary">89,99€</span>
                            </div>
                        </div>
                    </div>

                    <!-- Garanties -->
                    <div class="mt-6 pt-6 border-t border-gray-200 dark:border-gray-700">
                        <h3 class="font-semibold text-gray-900 dark:text-white mb-3">🛡️ Vos garanties</h3>
                        <div class="space-y-2 text-sm text-gray-600 dark:text-gray-400">
                            <div class="flex items-center">
                                <span class="text-green-500 mr-2">✅</span>
                                Satisfait ou remboursé 30 jours
                            </div>
                            <div class="flex items-center">
                                <span class="text-green-500 mr-2">✅</span>
                                Garantie constructeur 2 ans
                            </div>
                            <div class="flex items-center">
                                <span class="text-green-500 mr-2">✅</span>
                                Support client 24/7
                            </div>
                            <div class="flex items-center">
                                <span class="text-green-500 mr-2">✅</span>
                                Paiement sécurisé SSL
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading overlay -->
    <div id="loadingOverlay" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 rounded-xl p-8 text-center max-w-sm mx-4">
            <div class="animate-spin w-12 h-12 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"></div>
            <h3 class="text-lg font-semibold mb-2">Traitement de votre commande...</h3>
            <p class="text-gray-600 dark:text-gray-400">Veuillez patienter quelques instants</p>
        </div>
    </div>

    <!-- Scripts -->
    <script src="/assets/js/checkout-express.js"></script>
    <script>
        // Initialize checkout
        document.addEventListener('DOMContentLoaded', () => {
            window.expressCheckout = new ExpressCheckout();
        });
    </script>
</body>
</html>